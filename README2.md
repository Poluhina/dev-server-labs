# Лабораторная работа №2. Работа с базой данных
# Цель работы
Научиться проектировать и реализовывать REST API с несколькими связанными сущностями.

Освоить работу с PostgreSQL в приложении на Node.js + Express с использованием ORM или сырых SQL-запросов.

Реализовать корректные операции CRUD, а также фильтрацию, сортировку и пагинацию.

Освоить принципы работы связей «один ко многим» (1:N) в реляционных базах данных.

# Условие
Разработать сервис для управления задачами (todo list) с возможностью:

Просмотра списка задач.
Создания новой задачи.
Переключения статуса задачи (выполнена/не выполнена).
Удаления задачи.
Редактирования задачи.
Фильтрации задач по категориям.
Поиска задач по заголовку.
Пагинации списка задач.
В проекте должны быть реализованы две сущности:

categories — категории задач,
todos — сами задачи, каждая из которых относится к одной категории.
Сервис должен работать только как REST API, без HTML и шаблонов.

# Подготовка проекта
В начале необходимо устанавливать нужные зависимости для работы проекта.

# 1. Установка Prisma
Установила с помощью команды 
```
npm install prisma --save-dev
```
# 2. Установка Prisma Client
```
npm install @prisma/client
```
# 3. Установка Express и dotenv
```
npm install express dotevn
```
# 4. Инициализация Prisma
```
npx prisma init
```
# 5. Миграциия
Следуюзий шаг, выполнение первой миграции
```
npx prisma migrate dev --name init
```
# 6. Миграции и модели
```
npx prisma migrate dev --name init_models
```
# Шаг 1. Создание базы данных
Используя миграции, создайте две таблицы:

Таблица todos для хранения задач.
Таблица categories для хранения категорий задач.

Каждая из таблиц содержит поля ```created_at``` и ```updated_at```, которые Prisma автоматически создает под именем ```createdAt``` и ```updatedAt```.

```
Таблица categories
Поле	Тип	Описание
id	SERIAL (PK)	Уникальный идентификатор категории
name	VARCHAR(100)	Название категории
created_at	TIMESTAMP	Дата создания
updated_at	TIMESTAMP	Дата обновления
```

```
Таблица todos
Поле	Тип	Описание
id	UUID (PK)	Уникальный идентификатор задачи
title	TEXT	Название задачи (2–120 символов)
completed	BOOLEAN	Статус выполнения (по умолчанию false)
category_id	INT	Внешний ключ на категорию (опционально)
due_date	TIMESTAMP	Срок выполнения задачи (опционально)
created_at	TIMESTAMP	Дата создания
updated_at	TIMESTAMP	Дата последнего обновления
```
# Шаг 2. Создание моделей
Создайте модели для работы со следующими сущностями:

Todo
Category

Разрешается использовать ORM (Например, Sequelize, Prisma).

# Модель Category
```
model Category {
  id        Int       @id @default(autoincrement())
  name      String    @db.VarChar(100)
  todos     Todo[]
  createdAt DateTime @default(now())
  updateAt  DateTime @updateAt
}
```
# Модель Todo
```
model Todo {
  id         String    @id @default(uuid())
  title      String    @db.Text
  completed  Boolean   @default(false)
  dueDate    DateTime?
  categoryID Int?
  category   Category? @relation(fields: [categoryId], references: [id], onDelete: SetNull)
  createdAt DateTime   @default(now())
  updateAt  DateTime   @updateAt
}
```
# Контрольные вопросы
Что такое реляционная база данных и какие преимущества она предоставляет?

Реляционная база данных - это тип данных, где информация хранится в виде таблиц, а связи между данными задаются через ключи. Каждая таблица состоит из строк и столбцов.

Какие типы связей между таблицами существуют в реляционных базах данных?

Существуют несколько типов связей: 
- Один ко дному
- Один ко многим
- Многие ко многим

Что такое RESTful API и для чего он используется?

Это интерфейст для взаимодействия между сервером и клиентом по принципам REST.

Что такое SQL-инъекция и как защититься от неё?

Это атака, при которой мошеники вставляет SQL-код в запрос к базе данных, чтобы получить доступ к базе данных.

В чем разница между ORM и сырыми SQL-запросами? Какие преимущества и недостатки у каждого подхода?

ORM - библиотека которая позволяет работать с базой данных через объекто-оринтированое программирование

Сырые SQL-запросы - прямое использование SQL-запросов к базе данных.
